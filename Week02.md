 # Algorithm
### 求数组的全排列

**解题思路:排列本质的意义就是算所有数字在不同位置的可能性，可以从广度优先搜索和深度优先搜索，两者的区别在于一个搜索时每一次考虑到所有情况，一个在搜索时走向极端，然后再回过头来走向另一个极端情况。如果这道题采用广度优先，第一位将考虑所有n种情况，这样就形成了n个标志，而在下一步又有n-1个标志，设计的程序考虑众多，所有不适合。采用深度优先搜索，可以把
想象成对一棵树进行深度遍历，直到访问到其叶子节点，然后回溯上一步，把两个值交换一下，又是另一种解。到了倒数第三层，以此类推.....深度遍历退出的条件就是访问到叶子节点。**

```cpp
#include <cstdio>
#include <iostream>
#include <string>
#include <algorithm>
#include <vector>

using namespace std;

/*
深度优先遍历+回溯法

每一次固定一个数,然后递归进入后面数的多有可能
例如1,2,3
枚举第一位的时候,有3种情况
枚举第二位的时候,有两种情况,之前第一位的数就不能取了
枚举第三位的时候,只有一种情况
*/
class solution{
    public:
    vector<vector<int>>arr;
    vector<int> func(vector<vector<int>> &,vector<int>&,int first,int len);
};
vector<int> solution:: func(vector<vector<int>> &res,vector<int> &out,int first,int len)
{
    if (first==len)
    {
        /* code */
        res.emplace_back(out);
        return;
    }
    for (int i = first; i <len; ++i)
    {
        //移动动态数组
        swap(out[i],out[first]);
        //换一个数后相当于固定换的数的位置,first计数加1,往后找
        func(res,out,first+1,len);
        //撤销操作
        swap(out[i],out[first]);
    }     
}


```
 
 # Tip
 &ensp;&ensp;&ensp;&ensp;**物联网(Internet of     Things)是一种万物互联生态的简称，而在之间传输数据往往是很隐私数据。之前有看到过摄像头被破解、智能语音被破解等等案例，深知这方面是一个重要的问题，这是互联网快速发展留下的诟病，就没有办法了吗？一定会有，本文是IBM公司在物联网安全方面总结的经验，借此做一下笔记**。

##  第一部分 设计和构建安全的IoT解决方案
 &ensp;&ensp;&ensp;&ensp;IoT解决方案涉及到智能设备网络，家用电器、摄像头、电视机等等。它们嵌入电子芯片与云服务链接，得到指令、传输数据，而这些数据往往是很隐私的数据，所以在这方面，安全性成为了一个巨大的挑战。
1. **防范系统被破坏或损害**：IoT 应用程序的每一层都必须采取有效的预防措施来阻止黑客。例如，您需要加固设备，确保设备与云的通信是安全的。
2. **支持持续监视**：即使是受到最严密保护的系统也留有许多漏洞。另外，当下受到最严密保护的解决方案（包括硬件和软件）可能不足以防范未来的攻击。因此，您必须通过持续监视和不断升级系统来抵御最新的攻击形式，为您的安全措施提供补充。
3. **能迅速恢复**：如果发生了一次破坏，必须最大限度减少损害，而且必须尽快恢复系统。

&ensp;&ensp;&ensp;&ensp;任何拥有网络连接的设备都是脆弱的。IoT 设备所收集的个人数据对数据黑客和身份窃贼始终具有价值。另外，对IoT解决方案的网络攻击有可能损害物理服务和基础架构。例如，黑客曾攻击一辆在高速公路上行驶的切诺基Jeep 车。因此，安全的 IoT 应用程序不仅对企业声誉至关重要，对客户和解决方案用户的幸福安康也很重要。

&ensp;&ensp;&ensp;&ensp;IoT 安全性的实际设计和实现带来了新的挑战，也同样带来了创新机遇。在几乎所有应用程序的设计中，开发人员都会面临安全性与实用性之间的权衡。对于 IoT 解决方案，此问题更为严重。IoT 设备通常仅具有有限的计算能力和内存容量，这使得使用需要比这些设备所能提供的资源更高要求的复杂加密算法变得很困难。

&ensp;&ensp;&ensp;&ensp;而专门为物联网而设计的新协议，比如消息队列遥测传输 (Message Queuing Telemetry Transport, MQTT) 和受约束应用程序协议 (Constrained Application Protocol, CoAP)，可能需要开发或增强安全机制。

### 开发安全的 IoT 应用程序三层
1. **设备/网关层**：防范发送恶意命令的“虚假”服务器，或者防范尝试监听从设备发来的私有传感器数据的黑客。
2. **网络/传输层**：防范发送假的度量数据的“虚假”设备，这些数据可能损坏应用程序中持久保存的数据。
3. **应用层**：防范非法的数据使用，或防范在应用层中运行的分析流程被恶意操纵。

**其中最容易受攻击的是第三层——应用层，应用层包含任何连接 IoT 设备的应用程序，这可能包括本地 Web 应用程序、基于云的应用程序和移动应用程序。**

下图展示了一个典型的IoT 应用程序的三层：
![image](https://www.ibm.com/developerworks/cn/iot/library/iot-trs-secure-iot-solutions1/image001.png)


### 保护设备
设备安全性主要关注于确保在解决方案中使用了一组受信任的设备，并且这些设备可信任发送控制命令的代理或应用程序。

1. 用户 ID/密码身份验证
2. 一次性密码 (One Time Password, OTP) 身份验证
3. 服务器唯一 ID 身份验证
4. 消息有效负载身份验证

&ensp;&ensp;&ensp;&ensp;MQTT 是一种用于 IoT 设备和应用程序的最流行的消息协议，它得到了IoT领域的许多关键参与者的支持。MQTT 为 IoT 解决方案提供了一种轻量型、容易使用的通信协议。MQTT 本身指定了一些安全机制，但所有常见的实现都支持最新的安全标准，比如用于传输安全的 SSL/TLS。MQTT 没有强制要求对其应用程序使用某种特定的安全方法，而是将决定权留给了应用程序设计者。因此，IoT解决方案可以基于应用程序上下文和特定的安全需求。

&ensp;&ensp;&ensp;&ensp;大部分 MQTT 部署都使用了传输层安全 (Transport Layer Security, TLS)，所以数据已加密并经过了完整性验证。类似地，大部分 MQTT 实现（包括 IBM Watson IoT Platform 中的实现）也在 MQTT 服务器中使用了授权功能来控制访问。

&ensp;&ensp;&ensp;&ensp;除了设备模拟器程序之外，我们还提供了一个代理应用程序客户端，用于显示从设备收到的 MQTT 消息并向设备发送示例命令。这个代理应用程序客户端示例应用程序生成用于设备身份验证的 OTP 密钥，并发送唯一的应用程序ID供设备执行应用程序验证。这个客户端生成命令消息（包括有效和无效的消息）来测试不同场景。

### 设备身份验证
**使用用户名和密码执行身份验证**：MQTT协议在CONNECT消息中提供了username和password字段来执行设备身份验证。客户端在连接MQTT代理时必须发送用户名和密码。用户名是一个 UTF-8 编码的字符串，密码是二进制数据。它们最大为65535字节。MQTT协议不会加密用户名和密码，除非使用了传输层加密，否则会以明文格式发送它们。

**使用访问令牌执行身份验证**：如果客户端成功获取了访问令牌，那么可以在 CONNECT 消息中通过使用 password字段将令牌发送给代理。然后，用户名可以是一个用于识别访问令牌的特殊字符串。MQTT中的密码的大小限制为65535字节，所以令牌长度不能超过这个限制。
1. 检查来自令牌的签名的有效性
2. 检查令牌的有效期是否已过期
3. 检查授权服务器来查看令牌是否被撤销

### 使用一次性密码 (One time password, OTP) 执行身份验证
&ensp;&ensp;&ensp;&ensp;除了 MQTT 提供的身份验证机制之外，IoT 应用程序可能还需要实现额外的安全性来识别合适的设备。本文介绍了一种为这些情形实现基于 OTP 的身份验证的方法。OTP 身份验证是一种保护设备免受不当使用的有用机制，它消除了未授权用户获取访问权的风险。
借助此方法，在设备启动后，只有经过验证的用户才能开始与 IoT 应用程序进行通信。因为不是所有设备都拥有键盘输入能力，所以可实现一个简单的属性开关，根据设备类型来启用或禁用此安全方案。如果启用了 OTP 身份验证，设备会在启动后使用正常的 MQTT 消息向 IoT 代理应用程序发送 OTP 请求。 下图展示了详细的流程。
![image](https://www.ibm.com/developerworks/cn/iot/library/iot-trs-secure-iot-solutions1/image003.png)

### 基于证书的身份验证
&ensp;&ensp;&ensp;&ensp;一些代理（比如 HiveMQ、可用于为企业启用 M2M 和 IoT 功能的 MQTT 代理）支持设备证书，这些证书可由代理在相互身份验证过程中使用。在安全要求非常严格，而且设备可以配置证书的应用程序中，可以考虑采用这种身份验证。
在本文中，我们使用 IBM Watson IoT Platform 和 HiveMQ 来演示基于证书的双向 SSL 身份验证。它们都使用标准 MQTT 作为设备通信协议。

### 设备授权
&ensp;&ensp;&ensp;&ensp;授权机制可确保两个设备之间没有数据泄露。MQTT 是一种基于主题的发布/订阅协议。每条消息都在一个指定的主题上发布，而且每个订阅都有一个可包含通配符的主题过滤器。所以，授权基于发布/订阅和主题名称。大部分 MQTT 服务器都有某种途径来授予发布和订阅主题的权限。

### 使用 OAuth 2.0 的应用程序授权
&ensp;&ensp;&ensp;&ensp;如果企业希望对 MQTT 设备使用其集中化的授权机制，可以使用基于 OAuth 的框架。OAuth 2.0 实现了授权服务器与资源服务器（比如 MQTT 服务器）的分离。使用 OAuth 2.0 时，客户端将其凭证提供给授权服务器，然后，后者执行身份验证检查，并返回一个允许访问某个资源的访问令牌。随后，使用该访问令牌连接到 MQTT 服务器。MQTT 服务器验证访问令牌（通常通过与授权服务器通信），然后授予资源的访问权。下图描述了该流程：
![image](https://www.ibm.com/developerworks/cn/iot/library/iot-trs-secure-iot-solutions1/image006.png)

### 应用程序 ID 验证
&ensp;&ensp;&ensp;&ensp;应用程序 ID 验证是 IoT 应用程序与设备之间一个额外的安全层，用于确保任何虚假应用程序都无法向设备发送命令。此机制可用作启动安全机制和通信安全机制。通过使用此方案，设备会存储 IoT 应用程序的唯一 ID，并在处理从 IoT 应用程序传入的命令时验证它。如果 IoT 应用程序通过一个命令发送无效的唯一 ID，该命令会被设备忽略。如果设备拥有存储能力，那么可以加密和存储 IoT 应用程序的唯一 ID。在这种情况下，不必在每次重新启动后都发送唯一 ID 请求。
![image](https://www.ibm.com/developerworks/cn/iot/library/iot-trs-secure-iot-solutions1/image004.png)
1. 可根据设备能力来开启和关闭应用程序 ID 验证。
2. 在重新启动期间，如果启用了应用程序 ID 验证和唯一应用程序 ID 存储，那么设备会尝试从一个加密的文件还原 IoT 应用程序唯一 ID。
3. 如果设备无法加载唯一应用程序 ID，它会发起一个请求来获取该应用程序 ID。
4. 收到请求后，IoT 应用程序会将唯一 ID 发送给设备。
5. 设备将唯一 ID 存储在内存和一个文件中（如果它有存储能力）。
6. 在这之后，设备要求每个从 IoT 应用程序传入的命令中都包含的是同一个应用程序 ID。
7. 如果存在错误匹配，设备会忽略该命令。


### 保护设备免受其他安全问题
1. 安全引导。安全引导对保护启动代码免受攻击很重要。在初始引导过程中必须验证设备的真实性和完整性。附加到设备软件的数字签名可用于验证设备的真实性。
2. 设备固件升级。设备必须防御所有已知和未知的恶意攻击。必须开发一种安装定期安全2补丁的机制，确保所有设备都获得了定期升级。
3. 事故日志和监视。所有可能的安全事故都需要记录和持续监视。设备中的所有恶意活动都应立即触发代理对设备的取消注册。

### 自定义的加密消息
&ensp;&ensp;&ensp;&ensp;引入多层安全性和加密的灵活选项，可让用户感到安心，并保护敏感数据免受损害。 用户有时更喜欢基于 SSL 保护的自定义加密，或者它们可能在安全的通信不受支持时被迫使用它。

&ensp;&ensp;&ensp;&ensp;在此方案中，应用程序会加密消息，然后再将其发送给 MQTT 代理。密码 (cipher) 在设备和 IoT 应用程序之间交换，并用于加密或解密消息。IBM Watson IoT Platform 目前不支持自定义加密，但其他一些 MQTT 代理支持自定义加密，比如 HiveMQ。

#### 正确的设备身份验证方法取决于您设计的解决方案，以及该解决方案将要处理的数据种类。要记住的一些关键点包括：
1. 如果 IoT 数据是敏感的，则使用安全的连接。身份验证和受保护（加密）的通信都非常重要。
2. 在需要额外的安全级别时，在物理设备安全水平不够高（比如任何人都可以访问物理设备）时，使用一次性密码 (OTP)。
3. 基于代理的能力，使用 OAuth 等机制来支持外部授权提供商。
4. 或许通过使用固定主题字符串，严格控制订阅授权，这样可以防范恶意客户端进行大量订阅。
5. 限制消息大小，确保所有客户端或设备都无法自行阻塞代理。
6. 如果可以执行证书管理，可以考虑签发客户端证书，并只接受来自具有证书的客户端的连接。
